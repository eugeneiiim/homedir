alias gl='git log --graph --pretty=format:"%Cred%h %C(bold blue)%an%C(yellow)%d%Creset %s %Cgreen(%cr) %Creset" --abbrev-commit '

#alias gbr='for k in `git branch|perl -pe "s/^..//"`;do echo -e `git show --pretty=format:"%Cgreen%ci %Cblue%cr%Creset" $k|head -n 1`\\t$k;done|sort -r | head -n 25'

gbr2() {
  # Ensure we are in a git repository
  if ! git rev-parse --is-inside-work-tree >/dev/null 2>&1; then
    echo "Not a git repository."
    return 1
  fi

  # Get the UNIX timestamp for 7 days ago (compatible with Linux & macOS)
  if [[ "$OSTYPE" == "darwin"* ]]; then
    local week_ago=$(date -v-7d +%s)  # macOS
  else
    local week_ago=$(date -d "7 days ago" +%s)  # Linux
  fi

  # Print table header
  printf "%-20s %-40s\n" "Last Updated" "Branch Name"
  echo "--------------------------------------------------------------"

  # Fetch branches with their latest commit timestamps
  git for-each-ref --sort=-committerdate --format="%(committerdate:unix) %(committerdate:relative) | %(refname:short)" refs/heads/ |
  while IFS="|" read -r commit_info branch_name; do
    # Extract timestamp and relative date
    timestamp=$(echo "$commit_info" | awk '{print $1}')
    relative_date=$(echo "$commit_info" | cut -d' ' -f2-)

    # Ensure timestamp is numeric and compare with 7-day threshold
    if [[ "$timestamp" =~ ^[0-9]+$ ]]; then
      if [[ "$timestamp" -lt "$week_ago" ]]; then
        break  # Stop processing once we reach branches older than 7 days
      fi
      printf "%-20s %-40s\n" "$relative_date" "$branch_name"
    fi
  done
}

alias px='chmod +x'

alias gca='amend -C HEAD'

alias gs='git status'
alias gau='git ls-files --other --exclude-standard | xargs git add'
alias gb='git branch'
alias gc='git commit'
alias gd='git diff --ignore-space-at-eol'

#alias yp='yarn prettier'
alias yp='npx prettier --write . --ignore-path "$(git rev-parse --show-toplevel)/.prettierignore"'

alias yl='yarn lint:fix'
alias yt='yarn test'
alias yb='yarn build'
alias gdc='git diff --ignore-space-at-eol --cached'
alias dc='gdc'
alias grmd='git ls-files --deleted | xargs git rm'
alias glf='git ls-files'
alias glfd='git ls-files --deleted'
alias pull='git pull --rebase origin master'
alias push='git push origin master'
#alias pom='git push origin HEAD:master'
alias poh='git push --no-verify origin HEAD'
alias pho='poh'
alias gfo='git fetch origin'
alias gf='git fetch origin'
alias gsh='git show "HEAD"'
alias gshn='git show "HEAD" --name-only'
alias gsh2='git show "HEAD^"'
alias gsh3='git show "HEAD^^"'
alias gsh4='git show "HEAD^^^"'
alias gsh5='git show "HEAD^^^^"'
alias gsh6='git show "HEAD^^^^^^"'
alias gsh7='git show "HEAD^^^^^^^"'
alias gsh8='git show "HEAD^^^^^^^^"'
alias gsh9='git show "HEAD^^^^^^^^^"'
alias g='git'
alias brc='emacs ~/.bashrc'
alias cbrc='cat ~/.bashrc'
alias gsp='git stash pop'
alias grom='git rebase origin/master'
alias ro='git rebase origin/master'
alias grc='git rebase --continue'
alias gra='git rebase --abort'
alias grs='git reset --soft HEAD~ ; git status'
alias rs='git reset --soft HEAD~ ; git status'
alias gr='git reset'
alias ad='git add .'
alias gre='git reset'
alias gcm='git co master'

function add() {
  git add $@
  git status
}

alias a='git add'
alias ci='git commit --no-verify'
alias co='git checkout'

# function gg() {
#  ag $*
#  #git grep $1 | grep -v "models/gen" | less
#}
alias gg='ag --ignore-dir dev --ignore-dir logs --ignore-dir vendor --ignore-dir coverage'

alias e='emacs -nw'
alias ec='emacsclient -t'
alias ed='emacs --daemon'
alias ep='ps aux | grep emacs'
alias dz='. ~/.zshrc'
alias ez='emacs ~/.zsh_bash_common'
alias c='cd'

alias acs='apt-cache search'
alias agi='sudo apt-get install -y'

alias amend='git commit --amend'
alias dbrc='. ~/.bashrc'
alias srp='g stash && git rebase && gsp'
alias sr='g stash && git rebase && gsp'

export GIT_EDITOR='emacs --no-desktop'
export EDITOR=emacs

export PATH=$PATH:~/mongo/bin
export PATH=$PATH:~/bin
export PATH=$PATH:~/.scala/bin
export PATH=$PATH:/usr/local/share/npm/bin
export PATH=$PATH:/usr/local/share/python
export PATH=$PATH:node_modules/.bin
export PATH=$PATH:~/.pythonbrew/bin

alias rmtilde='find . -name "*~" | xargs rm'
alias rmtmp='find . -name ".#*" | xargs rm'
alias rmsvn='find . -name ".svn" | xargs rm -r'
alias rmr='rm -r'

alias srd='screen -r -d'
alias ss='screen -S'

alias k1='kill -9 %1'
alias k2='kill -9 %2'
alias k3='kill -9 %3'
alias k4='kill -9 %4'
alias k5='kill -9 %5'
alias k6='kill -9 %6'
alias kj='killall java'

alias emacsnd='emacs --no-desktop'
alias end='emacs --no-desktop'
alias m=make

cim() {
  MESSAGE=$@
  #git commit --no-verify -m "$MESSAGE"
  git commit -m "$MESSAGE"
}

export JAVA_HOME='/Applications/Android Studio.app/Contents/jbr/Contents/Home'

function set_upstream() {
  BRANCH=`git symbolic-ref --short HEAD`
  git branch --set-upstream-to=origin/$BRANCH $BRANCH
}

if [[ -r ~/.private ]]; then
    source ~/.private
fi

alias ap='git add -p'

export MAKEFLAGS='-j 8'

# Ensure that homebrew emacs is preferred over /usr/bin/emacs.
export PATH=/usr/local/opt/emacs/bin:$PATH

alias docker_stop_all='docker stop $(docker ps -a -q)'
alias docker_rm_all='docker rm $(docker ps -a -q)'
alias docker_kill_all='docker kill $(docker ps -a -q)'

export TERM=xterm-256color
RPROMPT='[%?]'

ulimit -n 4096
ulimit -u 1000

alias act='source venv/bin/activate'
alias du_dirs='du -d 0 -k * | sort -n'

eval $(ssh-agent)

export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm
[ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"  # This loads nvm bash_completion

export PATH=$PATH:/opt/homebrew/bin
export PATH=$PATH:/Library/TeX/texbin
export PATH=$PATH:/Users/eugenemarinelli/Library/Python/3.8/bin

export ANDROID_SDK=$HOME/Library/Android/sdk
export PATH=$HOME/Library/Android/sdk/platform-tools:$PATH
export PATH=$PATH:/Users/eugenemarinelli/Library/Android/sdk/cmake/3.22.1/bin
export ANDROID_NDK_HOME=/Users/eugenemarinelli/Library/Android/sdk/android-ndk-r12b
export ANDROID_SDK=/Users/eugenemarinelli/Library/Android/sdk
export ANDROID_SDK_ROOT=/Users/eugenemarinelli/Library/Android/sdk

export KUBECONFIG=~/.kube/realm-kubeconfig.yml
alias k=kubectl
alias d=docker

export PATH="/usr/local/opt/mysql-client/bin:$PATH"
export PATH="/usr/local/opt/openssl@3/bin:$PATH"

export PATH="/Users/eugenemarinelli/Library/Python/3.9/bin:$PATH"
export PATH=/opt/homebrew/opt/python@3.11/libexec/bin:$PATH

alias vlc='/Applications/VLC.app/Contents/MacOS/VLC'
export PATH="/opt/homebrew/opt/libpq/bin:$PATH"

alias lintb="git diff --name-only master -- '*.ts' '*.tsx' | sed 's|^cot-provider/||' | xargs yarn eslint --fix"

export PATH="$HOME/.local/bin:$PATH"

rwt() {
  local repo=~/repo/realmalliance/realm
  local dir_name="${1//\//-}"
  local dest=~/repo/realmalliance/realm-worktrees/"$dir_name"

  # Check if branch already has a worktree
  local existing=$(git -C "$repo" worktree list | grep -E "\[$1\]" | awk '{print $1}')
  if [[ -n "$existing" ]]; then
    cd "$existing"
    return
  fi

  git -C "$repo" fetch origin

  if git -C "$repo" show-ref --verify --quiet "refs/heads/$1"; then
    git -C "$repo" worktree add "$dest" "$1"
  elif git -C "$repo" show-ref --verify --quiet "refs/remotes/origin/$1"; then
    git -C "$repo" worktree add --track -b "$1" "$dest" "origin/$1"
  else
    git -C "$repo" worktree add -b "$1" "$dest" origin/master
  fi && cd "$dest" && git pull
}

alias csp='claude --dangerously-skip-permissions'

alias cursor='/Applications/Cursor.app/Contents/MacOS/Cursor'